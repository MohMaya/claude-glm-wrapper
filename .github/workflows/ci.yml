# CI Workflow - Runs on all PRs and pushes to main
# Validates: type-check, build, and tests using Bun

name: CI

on:
  pull_request:
    branches: ['**']
  push:
    branches: [main]

jobs:
  validate:
    name: Validate (Bun)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Bun
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Install dependencies
        run: bun install

      # Note: 'bun run lint' assumes eslint is setup. If not, remove this step or fix it.
      # Currently we focused on tsc/build.
      
      - name: Type check (Strict)
        run: |
           # Create a temporary tsconfig for strict checking if needed or just verify types
           # Bun doesn't have a direct 'typecheck' command, it uses tsc
           bun add -d typescript
           bun x tsc --noEmit --skipLibCheck

      - name: Build Binary
        run: bun run build

      # Add test step if tests exist in bun format
      # - name: Run tests
      #   run: bun test
